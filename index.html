<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GameZone | 20 –ò–≥—Ä</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui,sans-serif;background:#0a0a1a;color:#fff;min-height:100vh}
header{padding:15px 30px;display:flex;align-items:center;justify-content:space-between;background:rgba(10,10,26,0.95);position:sticky;top:0;z-index:100}
.logo{font-family:'Orbitron',sans-serif;font-size:1.8rem;font-weight:900;background:linear-gradient(135deg,#0ff,#f0a);-webkit-background-clip:text;-webkit-text-fill-color:transparent;cursor:pointer}
.search-box{flex:1;max-width:400px;margin:0 30px}
.search-box input{width:100%;padding:12px 20px;border:2px solid rgba(255,255,255,0.1);border-radius:30px;background:#12122a;color:#fff;font-size:1rem;outline:none}
main{padding:30px;max-width:1600px;margin:0 auto}
.stats{display:flex;gap:30px;margin-bottom:25px}
.stat-val{font-family:'Orbitron';font-size:2rem;color:#0ff}
.stat-lbl{color:#888;font-size:0.85rem}
.categories{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:30px}
.cat-btn{padding:10px 20px;border:none;border-radius:25px;background:#12122a;color:#fff;font-weight:600;cursor:pointer;transition:all 0.3s}
.cat-btn:hover,.cat-btn.active{background:linear-gradient(135deg,#0ff,#08f);color:#000}
.games-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:20px}
.game-card{position:relative;border-radius:16px;overflow:hidden;background:#12122a;cursor:pointer;transition:all 0.3s;aspect-ratio:1}
.game-card:hover{transform:translateY(-8px);box-shadow:0 15px 40px rgba(0,0,0,0.4)}
.game-card::before{content:'';position:absolute;inset:0;background:linear-gradient(180deg,transparent 50%,rgba(0,0,0,0.9) 100%);z-index:1}
.game-icon{width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:3.5rem;background:linear-gradient(135deg,#12122a,#1a1a3a)}
.game-info{position:absolute;bottom:0;left:0;right:0;padding:15px;z-index:2}
.game-name{font-weight:700;font-size:0.95rem}
.game-cat{font-size:0.75rem;color:#0ff}
.play-btn{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);width:60px;height:60px;background:linear-gradient(135deg,#f0a,#f60);border-radius:50%;display:flex;align-items:center;justify-content:center;z-index:3;transition:all 0.3s}
.game-card:hover .play-btn{transform:translate(-50%,-50%) scale(1)}
.play-btn::after{content:'‚ñ∂';color:white;font-size:1.5rem;margin-left:4px}
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:1000;display:none;align-items:center;justify-content:center;padding:20px}
.modal.active{display:flex}
.modal-box{width:100%;max-width:850px;background:#12122a;border-radius:20px;overflow:hidden}
.modal-head{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:rgba(0,0,0,0.3)}
.modal-title{font-family:'Orbitron';font-size:1.2rem}
.modal-close{width:40px;height:40px;border:none;border-radius:50%;background:rgba(255,255,255,0.1);color:white;font-size:1.5rem;cursor:pointer}
.game-area{min-height:480px;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:25px;background:#0a0a1a;gap:15px}
.game-canvas{border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,0.5)}
.game-score{font-family:'Orbitron';font-size:1.2rem;color:#0ff}
.game-hint{color:#888;font-size:0.85rem}
footer{text-align:center;padding:30px;color:#888}
</style>
</head>
<body>
<header>
<div class="logo" onclick="location.reload()">GameZone</div>
<div class="search-box"><input type="text" id="search" placeholder="üîç –ü–æ–∏—Å–∫..." oninput="filter()"></div>
</header>
<main>
<div class="stats">
<div class="stat"><div class="stat-val">20</div><div class="stat-lbl">–ò–≥—Ä</div></div>
<div class="stat"><div class="stat-val">7</div><div class="stat-lbl">–ñ–∞–Ω—Ä–æ–≤</div></div>
</div>
<div class="categories" id="cats"></div>
<div class="games-grid" id="grid"></div>
</main>
<footer>¬© 2025 GameZone</footer>
<div class="modal" id="modal">
<div class="modal-box">
<div class="modal-head">
<span class="modal-title" id="mtitle">–ò–≥—Ä–∞</span>
<button class="modal-close" onclick="closeGame()">√ó</button>
</div>
<div class="game-area" id="gameArea"></div>
</div>
</div>
<script>
const categories=[{id:'all',name:'–í—Å–µ',icon:'üéÆ'},{id:'arcade',name:'–ê—Ä–∫–∞–¥—ã',icon:'üëæ'},{id:'puzzle',name:'–ì–æ–ª–æ–≤–æ–ª–æ–º–∫–∏',icon:'üß©'},{id:'strategy',name:'–°—Ç—Ä–∞—Ç–µ–≥–∏–∏',icon:'‚ôüÔ∏è'},{id:'racing',name:'–ì–æ–Ω–∫–∏',icon:'üèéÔ∏è'},{id:'sports',name:'–°–ø–æ—Ä—Ç',icon:'‚öΩ'},{id:'logic',name:'–õ–æ–≥–∏—á–µ—Å–∫–∏–µ',icon:'üß†'},{id:'casual',name:'–ö–∞–∑—É–∞–ª—å–Ω—ã–µ',icon:'üéØ'}];
const games=[{id:1,name:'–ó–º–µ–π–∫–∞',icon:'üêç',cat:'arcade'},{id:2,name:'–¢–µ—Ç—Ä–∏—Å',icon:'üß±',cat:'arcade'},{id:3,name:'–ü–∏–Ω–≥-–ø–æ–Ω–≥',icon:'üèì',cat:'arcade'},{id:4,name:'Flappy Bird',icon:'üê¶',cat:'arcade'},{id:5,name:'–ê—Ä–∫–∞–Ω–æ–∏–¥',icon:'üéØ',cat:'arcade'},{id:6,name:'Pac-Man',icon:'üëª',cat:'arcade'},{id:7,name:'Space Invaders',icon:'üëΩ',cat:'arcade'},{id:8,name:'Asteroids',icon:'‚òÑÔ∏è',cat:'arcade'},{id:9,name:'–ú–∞—Ä–∏–æ',icon:'üçÑ',cat:'arcade'},{id:16,name:'2048',icon:'üî¢',cat:'puzzle'},{id:17,name:'–ü–∞–º—è—Ç—å',icon:'üß†',cat:'puzzle'},{id:27,name:'–¢–µ—Ç—Ä–∏—Å –ü–∞–∑–ª',icon:'üî∑',cat:'puzzle'},{id:28,name:'–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏',icon:'‚≠ï',cat:'strategy'},{id:38,name:'–ì–æ–Ω–∫–∏',icon:'üõ£Ô∏è',cat:'racing'},{id:48,name:'–§—É—Ç–±–æ–ª',icon:'‚öΩ',cat:'sports'},{id:50,name:'–¢–µ–Ω–Ω–∏—Å',icon:'üéæ',cat:'sports'},{id:91,name:'–°–∏–º–æ–Ω',icon:'üé®',cat:'logic'},{id:94,name:'–ö–ª–∏–∫–µ—Ä',icon:'üëÜ',cat:'casual'},{id:95,name:'–†–µ–∞–∫—Ü–∏—è',icon:'‚ö°',cat:'casual'},{id:96,name:'–†—ã–±–∞–ª–∫–∞',icon:'üé£',cat:'casual'}];
let currentCat='all',gameLoop=null;
document.addEventListener('DOMContentLoaded',()=>{renderCategories();renderGames();});
function renderCategories(){document.getElementById('cats').innerHTML=categories.map(c=>`<button class="cat-btn ${c.id==='all'?'active':''}" data-cat="${c.id}" onclick="selectCat('${c.id}')">${c.icon} ${c.name}</button>`).join('');}
function selectCat(cat){currentCat=cat;document.querySelectorAll('.cat-btn').forEach(b=>b.classList.toggle('active',b.dataset.cat===cat));renderGames();}
function renderGames(){const q=document.getElementById('search').value.toLowerCase();let list=games;if(currentCat!=='all')list=list.filter(g=>g.cat===currentCat);if(q)list=list.filter(g=>g.name.toLowerCase().includes(q));document.getElementById('grid').innerHTML=list.map(g=>`<div class="game-card" onclick="openGame(${g.id})"><div class="game-icon">${g.icon}</div><div class="game-info"><div class="game-name">${g.name}</div><div class="game-cat">${categories.find(c=>c.id===g.cat)?.name||''}</div></div><div class="play-btn"></div></div>`).join('');}
function filter(){renderGames();}
function openGame(id){const game=games.find(g=>g.id===id);document.getElementById('mtitle').textContent=game.name;document.getElementById('modal').classList.add('active');document.body.style.overflow='hidden';initGame(id);}
function closeGame(){document.getElementById('modal').classList.remove('active');document.getElementById('gameArea').innerHTML='';document.body.style.overflow='';if(gameLoop){clearInterval(gameLoop);gameLoop=null;}document.onkeydown=null;document.onkeyup=null;}
document.getElementById('modal').onclick=e=>{if(e.target.id==='modal')closeGame();};
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeGame();});
function initGame(id){const area=document.getElementById('gameArea');area.innerHTML='';switch(id){case 1:game_snake(area);break;case 2:game_tetris(area);break;case 3:case 50:game_pong(area);break;case 4:game_flappy(area);break;case 5:game_breakout(area);break;case 6:game_pacman(area);break;case 7:game_invaders(area);break;case 8:game_asteroids(area);break;case 9:game_mario(area);break;case 16:case 27:game_2048(area);break;case 17:game_memory(area);break;case 28:game_tictactoe(area);break;case 38:game_road(area);break;case 48:game_football(area);break;case 91:game_simon(area);break;case 94:game_clicker(area);break;case 95:game_reaction(area);break;case 96:game_fishing(area);break;}}
function createCanvas(area,w,h){area.innerHTML=`<div class="game-score">–°—á—ë—Ç: <span id="score">0</span></div><canvas id="cv" class="game-canvas" width="${w}" height="${h}"></canvas><div class="game-hint" id="hint"></div>`;return document.getElementById('cv');}
function setScore(s){document.getElementById('score').textContent=s;}
function setHint(h){document.getElementById('hint').textContent=h;}

// –ó–ú–ï–ô–ö–ê
function game_snake(area){const cv=createCanvas(area,500,500);const ctx=cv.getContext('2d');setHint('–°—Ç—Ä–µ–ª–∫–∏/WASD');const sz=25,tiles=20;let snake=[{x:10,y:10}],food={x:15,y:15},dx=0,dy=0,score=0,over=false;
function draw(){ctx.fillStyle='#1a2a1a';ctx.fillRect(0,0,500,500);ctx.strokeStyle='rgba(0,255,0,0.1)';for(let i=0;i<=tiles;i++){ctx.beginPath();ctx.moveTo(i*sz,0);ctx.lineTo(i*sz,500);ctx.stroke();ctx.beginPath();ctx.moveTo(0,i*sz);ctx.lineTo(500,i*sz);ctx.stroke();}
snake.forEach((s,i)=>{const a=1-i/snake.length*0.5;ctx.fillStyle='rgba(0,0,0,0.3)';ctx.beginPath();ctx.roundRect(s.x*sz+4,s.y*sz+6,sz-6,sz-6,6);ctx.fill();ctx.fillStyle=`rgba(50,255,50,${a})`;ctx.beginPath();ctx.roundRect(s.x*sz+2,s.y*sz+2,sz-4,sz-4,6);ctx.fill();if(i===0){ctx.fillStyle='#fff';ctx.beginPath();ctx.arc(s.x*sz+8+dx*3,s.y*sz+10+dy*3,4,0,Math.PI*2);ctx.arc(s.x*sz+16+dx*3,s.y*sz+10+dy*3,4,0,Math.PI*2);ctx.fill();ctx.fillStyle='#000';ctx.beginPath();ctx.arc(s.x*sz+8+dx*5,s.y*sz+10+dy*5,2,0,Math.PI*2);ctx.arc(s.x*sz+16+dx*5,s.y*sz+10+dy*5,2,0,Math.PI*2);ctx.fill();}});
ctx.fillStyle='#f00';ctx.beginPath();ctx.arc(food.x*sz+sz/2,food.y*sz+sz/2,10,0,Math.PI*2);ctx.fill();ctx.fillStyle='#0a0';ctx.beginPath();ctx.ellipse(food.x*sz+sz/2+2,food.y*sz+sz/2-10,4,6,0.5,0,Math.PI*2);ctx.fill();
if(over){ctx.fillStyle='rgba(0,0,0,0.8)';ctx.fillRect(0,0,500,500);ctx.fillStyle='#f44';ctx.font='bold 40px Orbitron';ctx.textAlign='center';ctx.fillText('GAME OVER',250,230);ctx.fillStyle='#0f0';ctx.font='30px Orbitron';ctx.fillText('–°—á—ë—Ç: '+score,250,280);ctx.fillStyle='#fff';ctx.font='16px sans-serif';ctx.fillText('–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è —Ä–µ—Å—Ç–∞—Ä—Ç–∞',250,330);ctx.textAlign='left';}}
function update(){if(over||(!dx&&!dy))return;const head={x:snake[0].x+dx,y:snake[0].y+dy};if(head.x<0||head.x>=tiles||head.y<0||head.y>=tiles||snake.some(s=>s.x===head.x&&s.y===head.y)){over=true;return;}snake.unshift(head);if(head.x===food.x&&head.y===food.y){score+=10;setScore(score);do{food={x:Math.floor(Math.random()*tiles),y:Math.floor(Math.random()*tiles)};}while(snake.some(s=>s.x===food.x&&s.y===food.y));}else snake.pop();}
gameLoop=setInterval(()=>{update();draw();},100);cv.onclick=()=>{if(over)game_snake(area);};
document.onkeydown=e=>{if(['ArrowUp','w','W'].includes(e.key)&&dy!==1){dx=0;dy=-1;}if(['ArrowDown','s','S'].includes(e.key)&&dy!==-1){dx=0;dy=1;}if(['ArrowLeft','a','A'].includes(e.key)&&dx!==1){dx=-1;dy=0;}if(['ArrowRight','d','D'].includes(e.key)&&dx!==-1){dx=1;dy=0;}e.preventDefault();};}

// –¢–ï–¢–†–ò–°
function game_tetris(area){const cv=createCanvas(area,320,600);const ctx=cv.getContext('2d');setHint('‚Üê ‚Üí ‚Üì ‚Üë');const COLS=10,ROWS=20,B=30;const SHAPES=[[[1,1,1,1]],[[1,1],[1,1]],[[1,1,1],[0,1,0]],[[1,1,1],[1,0,0]],[[1,1,1],[0,0,1]],[[1,1,0],[0,1,1]],[[0,1,1],[1,1,0]]];const COLORS=['#0ff','#ff0','#f0f','#f80','#08f','#0f0','#f00'];let board=Array(ROWS).fill().map(()=>Array(COLS).fill(0)),score=0,over=false,piece,px,py,pc,pi;
function newPiece(){pi=Math.floor(Math.random()*SHAPES.length);piece=SHAPES[pi].map(r=>[...r]);pc=COLORS[pi];px=Math.floor(COLS/2)-Math.floor(piece[0].length/2);py=0;if(!canMove(0,0))over=true;}
function canMove(ox,oy,p=piece){for(let y=0;y<p.length;y++)for(let x=0;x<p[y].length;x++)if(p[y][x]){const nx=px+x+ox,ny=py+y+oy;if(nx<0||nx>=COLS||ny>=ROWS||(ny>=0&&board[ny][nx]))return false;}return true;}
function merge(){piece.forEach((r,y)=>r.forEach((v,x)=>{if(v&&py+y>=0)board[py+y][px+x]=pc;}));}
function clear(){for(let y=ROWS-1;y>=0;y--)if(board[y].every(c=>c)){board.splice(y,1);board.unshift(Array(COLS).fill(0));score+=100;setScore(score);y++;}}
function rotate(){const r=piece[0].map((_,i)=>piece.map(row=>row[i]).reverse());if(canMove(0,0,r))piece=r;}
function draw(){ctx.fillStyle='#1a1a2e';ctx.fillRect(0,0,320,600);board.forEach((row,y)=>row.forEach((c,x)=>{if(c){ctx.fillStyle=c;ctx.fillRect(x*B+1,y*B+1,B-2,B-2);}}));piece.forEach((row,y)=>row.forEach((v,x)=>{if(v){ctx.fillStyle=pc;ctx.fillRect((px+x)*B+1,(py+y)*B+1,B-2,B-2);}}));
if(over){ctx.fillStyle='rgba(0,0,0,0.85)';ctx.fillRect(0,0,320,600);ctx.fillStyle='#f0a';ctx.font='bold 32px Orbitron';ctx.textAlign='center';ctx.fillText('GAME OVER',160,270);ctx.fillStyle='#0ff';ctx.font='24px Orbitron';ctx.fillText(score,160,320);ctx.textAlign='left';}}
let drop=0;function loop(){if(over)return;drop++;if(drop>5){drop=0;if(canMove(0,1))py++;else{merge();clear();newPiece();}}draw();}
newPiece();gameLoop=setInterval(loop,50);cv.onclick=()=>{if(over)game_tetris(area);};
document.onkeydown=e=>{if(over)return;if(e.key==='ArrowLeft'&&canMove(-1,0))px--;if(e.key==='ArrowRight'&&canMove(1,0))px++;if(e.key==='ArrowDown'&&canMove(0,1))py++;if(e.key==='ArrowUp')rotate();e.preventDefault();};}

// –ü–ò–ù–ì-–ü–û–ù–ì
function game_pong(area){const cv=createCanvas(area,600,400);const ctx=cv.getContext('2d');setHint('‚Üë‚Üì –∏–ª–∏ WS');let py=150,ay=150,bx=300,by=200,bdx=5,bdy=3,s1=0,s2=0;let keys={};document.onkeydown=e=>{keys[e.key]=true;e.preventDefault();};document.onkeyup=e=>keys[e.key]=false;
function loop(){if(keys['ArrowUp']||keys['w'])py=Math.max(0,py-7);if(keys['ArrowDown']||keys['s'])py=Math.min(300,py+7);if(ay+50<by)ay+=4;if(ay+50>by)ay-=4;bx+=bdx;by+=bdy;if(by<=5||by>=395)bdy*=-1;if(bx<=25&&by>=py&&by<=py+100){bdx=Math.abs(bdx);bdy+=(by-py-50)*0.1;}if(bx>=575&&by>=ay&&by<=ay+100){bdx=-Math.abs(bdx);bdy+=(by-ay-50)*0.1;}if(bx<0){s2++;bx=300;by=200;bdx=5;}if(bx>600){s1++;bx=300;by=200;bdx=-5;}setScore(s1+' : '+s2);
ctx.fillStyle='#0a4a2a';ctx.fillRect(0,0,600,400);ctx.strokeStyle='#fff';ctx.lineWidth=2;ctx.setLineDash([10,10]);ctx.beginPath();ctx.moveTo(300,0);ctx.lineTo(300,400);ctx.stroke();ctx.setLineDash([]);ctx.fillStyle='#0af';ctx.fillRect(10,py,15,100);ctx.fillStyle='#f50';ctx.fillRect(575,ay,15,100);ctx.fillStyle='#fff';ctx.beginPath();ctx.arc(bx,by,10,0,Math.PI*2);ctx.fill();}
gameLoop=setInterval(loop,16);}

// FLAPPY BIRD
function game_flappy(area){const cv=createCanvas(area,400,550);const ctx=cv.getContext('2d');setHint('–ü—Ä–æ–±–µ–ª/–∫–ª–∏–∫');let bird={x:80,y:250,vel:0},pipes=[],score=0,over=false,started=false;
function jump(){if(over){game_flappy(area);return;}started=true;bird.vel=-9;}document.onkeydown=e=>{if(e.code==='Space'){e.preventDefault();jump();}};cv.onclick=jump;
function loop(){if(started&&!over){bird.vel+=0.4;bird.y+=bird.vel;if(bird.y>520||bird.y<0){over=true;return;}if(!pipes.length||pipes[pipes.length-1].x<220){const gy=100+Math.random()*250;pipes.push({x:400,gy,gap:150,passed:false});}pipes.forEach(p=>{p.x-=3;if(bird.x+15>p.x&&bird.x-15<p.x+60&&(bird.y-12<p.gy||bird.y+12>p.gy+p.gap))over=true;if(!p.passed&&p.x+60<bird.x){p.passed=true;score++;setScore(score);}});pipes=pipes.filter(p=>p.x>-70);}
ctx.fillStyle='#87ceeb';ctx.fillRect(0,0,400,550);ctx.fillStyle='#5a3';ctx.fillRect(0,500,400,50);pipes.forEach(p=>{ctx.fillStyle='#3a2';ctx.fillRect(p.x,0,60,p.gy);ctx.fillRect(p.x,p.gy+p.gap,60,550);});ctx.fillStyle='#fc0';ctx.beginPath();ctx.arc(bird.x,bird.y,15,0,Math.PI*2);ctx.fill();ctx.fillStyle='#fff';ctx.beginPath();ctx.arc(bird.x+5,bird.y-3,5,0,Math.PI*2);ctx.fill();ctx.fillStyle='#000';ctx.beginPath();ctx.arc(bird.x+6,bird.y-3,2,0,Math.PI*2);ctx.fill();ctx.fillStyle='#f50';ctx.beginPath();ctx.moveTo(bird.x+12,bird.y);ctx.lineTo(bird.x+22,bird.y+3);ctx.lineTo(bird.x+12,bird.y+6);ctx.fill();
if(!started){ctx.fillStyle='rgba(0,0,0,0.4)';ctx.fillRect(0,0,400,550);ctx.fillStyle='#fff';ctx.font='bold 22px Orbitron';ctx.textAlign='center';ctx.fillText('–ù–∞–∂–º–∏—Ç–µ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞',200,275);ctx.textAlign='left';}
if(over){ctx.fillStyle='rgba(0,0,0,0.7)';ctx.fillRect(0,0,400,550);ctx.fillStyle='#f66';ctx.font='bold 34px Orbitron';ctx.textAlign='center';ctx.fillText('GAME OVER',200,250);ctx.fillStyle='#fff';ctx.font='26px Orbitron';ctx.fillText('–°—á—ë—Ç: '+score,200,300);ctx.textAlign='left';}}
gameLoop=setInterval(loop,16);}

// –ê–†–ö–ê–ù–û–ò–î
function game_breakout(area){const cv=createCanvas(area,550,450);const ctx=cv.getContext('2d');setHint('‚Üê ‚Üí –∏–ª–∏ –º—ã—à—å');let px=225,bx=275,by=380,bdx=4,bdy=-4,score=0,over=false;const colors=['#f66','#fc5','#4df','#f9f','#54f'];let bricks=[];for(let r=0;r<5;r++)for(let c=0;c<10;c++)bricks.push({x:c*53+10,y:r*28+40,w:50,h:25,alive:true,color:colors[r]});cv.onmousemove=e=>{const r=cv.getBoundingClientRect();px=e.clientX-r.left-50;px=Math.max(0,Math.min(450,px));};let keys={};document.onkeydown=e=>{keys[e.key]=true;e.preventDefault();};document.onkeyup=e=>keys[e.key]=false;
function loop(){if(over)return;if(keys['ArrowLeft'])px=Math.max(0,px-8);if(keys['ArrowRight'])px=Math.min(450,px+8);bx+=bdx;by+=bdy;if(bx<=6||bx>=544)bdx*=-1;if(by<=6)bdy*=-1;if(by>=420&&bx>=px&&bx<=px+100){bdy=-Math.abs(bdy);bdx+=(bx-px-50)*0.08;}if(by>450){over=true;return;}let alive=0;bricks.forEach(b=>{if(b.alive){alive++;if(bx>=b.x&&bx<=b.x+b.w&&by>=b.y&&by<=b.y+b.h){b.alive=false;bdy*=-1;score+=10;setScore(score);}}});if(alive===0)over=true;
ctx.fillStyle='#1a1a2e';ctx.fillRect(0,0,550,450);bricks.forEach(b=>{if(b.alive){ctx.fillStyle=b.color;ctx.beginPath();ctx.roundRect(b.x,b.y,b.w,b.h,4);ctx.fill();}});ctx.fillStyle='#0ff';ctx.beginPath();ctx.roundRect(px,425,100,12,6);ctx.fill();ctx.fillStyle='#fff';ctx.beginPath();ctx.arc(bx,by,7,0,Math.PI*2);ctx.fill();
if(over){ctx.fillStyle='rgba(0,0,0,0.8)';ctx.fillRect(0,0,550,450);ctx.fillStyle=alive===0?'#0f8':'#f44';ctx.font='bold 34px Orbitron';ctx.textAlign='center';ctx.fillText(alive===0?'–ü–û–ë–ï–î–ê!':'GAME OVER',275,210);ctx.fillStyle='#0ff';ctx.font='26px Orbitron';ctx.fillText(score,275,260);ctx.textAlign='left';}}
gameLoop=setInterval(loop,16);cv.onclick=()=>{if(over)game_breakout(area);};}

// PAC-MAN
function game_pacman(area){const cv=createCanvas(area,500,500);const ctx=cv.getContext('2d');setHint('–°—Ç—Ä–µ–ª–∫–∏');const sz=25,tiles=20;let pac={x:10,y:10,dx:0,dy:0},score=0,mouth=0,over=false;let dots=[],ghosts=[{x:5,y:5,dx:1,dy:0,c:'#f00'},{x:15,y:5,dx:-1,dy:0,c:'#0ff'},{x:5,y:15,dx:1,dy:0,c:'#fbf'},{x:15,y:15,dx:-1,dy:0,c:'#fb5'}];for(let y=0;y<tiles;y++)for(let x=0;x<tiles;x++)if(Math.random()>0.25)dots.push({x,y});
function loop(){if(over)return;pac.x+=pac.dx*0.12;pac.y+=pac.dy*0.12;if(pac.x<0)pac.x=tiles-1;if(pac.x>=tiles)pac.x=0;if(pac.y<0)pac.y=tiles-1;if(pac.y>=tiles)pac.y=0;dots=dots.filter(d=>{if(Math.abs(d.x-pac.x)<0.5&&Math.abs(d.y-pac.y)<0.5){score+=10;setScore(score);return false;}return true;});ghosts.forEach(g=>{g.x+=g.dx*0.06;g.y+=g.dy*0.06;if(g.x<0||g.x>=tiles)g.dx*=-1;if(g.y<0||g.y>=tiles)g.dy*=-1;if(Math.random()<0.02){if(Math.random()>0.5){g.dx=Math.random()>0.5?1:-1;g.dy=0;}else{g.dy=Math.random()>0.5?1:-1;g.dx=0;}}if(Math.abs(g.x-pac.x)<0.7&&Math.abs(g.y-pac.y)<0.7)over=true;});mouth=(mouth+0.15)%1;
ctx.fillStyle='#000';ctx.fillRect(0,0,500,500);ctx.fillStyle='#ffb8ae';dots.forEach(d=>{ctx.beginPath();ctx.arc(d.x*sz+sz/2,d.y*sz+sz/2,3,0,Math.PI*2);ctx.fill();});ctx.save();ctx.translate(pac.x*sz+sz/2,pac.y*sz+sz/2);let angle=0;if(pac.dx>0)angle=0;if(pac.dx<0)angle=Math.PI;if(pac.dy>0)angle=Math.PI/2;if(pac.dy<0)angle=-Math.PI/2;ctx.rotate(angle);ctx.fillStyle='#ff0';ctx.beginPath();ctx.arc(0,0,12,mouth*0.4,Math.PI*2-mouth*0.4);ctx.lineTo(0,0);ctx.fill();ctx.restore();ghosts.forEach(g=>{ctx.fillStyle=g.c;ctx.beginPath();ctx.arc(g.x*sz+sz/2,g.y*sz+sz/2-3,11,Math.PI,0);ctx.fill();ctx.fillRect(g.x*sz+sz/2-11,g.y*sz+sz/2-3,22,14);ctx.fillStyle='#fff';ctx.beginPath();ctx.arc(g.x*sz+sz/2-4,g.y*sz+sz/2-4,4,0,Math.PI*2);ctx.arc(g.x*sz+sz/2+4,g.y*sz+sz/2-4,4,0,Math.PI*2);ctx.fill();});
if(over){ctx.fillStyle='rgba(0,0,0,0.8)';ctx.fillRect(0,0,500,500);ctx.fillStyle='#ff0';ctx.font='bold 34px Orbitron';ctx.textAlign='center';ctx.fillText('GAME OVER',250,230);ctx.fillStyle='#fff';ctx.font='22px Orbitron';ctx.fillText('–°—á—ë—Ç: '+score,250,280);ctx.textAlign='left';}}
gameLoop=setInterval(loop,30);cv.onclick=()=>{if(over)game_pacman(area);};document.onkeydown=e=>{if(e.key==='ArrowUp'){pac.dx=0;pac.dy=-1;}if(e.key==='ArrowDown'){pac.dx=0;pac.dy=1;}if(e.key==='ArrowLeft'){pac.dx=-1;pac.dy=0;}if(e.key==='ArrowRight'){pac.dx=1;pac.dy=0;}e.preventDefault();};}

// SPACE INVADERS
function game_invaders(area){const cv=createCanvas(area,480,550);const ctx=cv.getContext('2d');setHint('‚Üê ‚Üí –ü—Ä–æ–±–µ–ª');let px=220,bullets=[],enemies=[],score=0,over=false;for(let r=0;r<4;r++)for(let c=0;c<8;c++)enemies.push({x:c*55+30,y:r*45+50,alive:true,type:r});let enemyDir=1;let keys={};document.onkeydown=e=>{keys[e.key]=true;if(e.code==='Space'&&!over){bullets.push({x:px+17,y:490});e.preventDefault();}};document.onkeyup=e=>keys[e.key]=false;
function loop(){if(over)return;if(keys['ArrowLeft'])px=Math.max(0,px-5);if(keys['ArrowRight'])px=Math.min(440,px+5);bullets.forEach(b=>b.y-=8);bullets=bullets.filter(b=>b.y>0);let moveDown=false;enemies.forEach(e=>{if(e.alive){e.x+=enemyDir;if(e.x<10||e.x>430)moveDown=true;}});if(moveDown){enemyDir*=-1;enemies.forEach(e=>e.y+=20);}bullets.forEach(b=>{enemies.forEach(e=>{if(e.alive&&b.x>e.x&&b.x<e.x+35&&b.y>e.y&&b.y<e.y+30){e.alive=false;score+=(4-e.type)*50;setScore(score);}});});if(!enemies.some(e=>e.alive)||enemies.some(e=>e.alive&&e.y>450))over=true;
ctx.fillStyle='#000';ctx.fillRect(0,0,480,550);const colors=['#f00','#f80','#ff0','#0f0'];enemies.forEach(e=>{if(!e.alive)return;ctx.fillStyle=colors[e.type];ctx.beginPath();ctx.arc(e.x+17,e.y+12,13,Math.PI,0);ctx.fill();ctx.fillRect(e.x+4,e.y+12,26,14);});ctx.fillStyle='#0ff';ctx.beginPath();ctx.moveTo(px+17,495);ctx.lineTo(px+35,520);ctx.lineTo(px,520);ctx.fill();ctx.fillStyle='#0f0';bullets.forEach(b=>ctx.fillRect(b.x-2,b.y,4,12));
if(over){ctx.fillStyle='rgba(0,0,0,0.8)';ctx.fillRect(0,0,480,550);ctx.fillStyle=enemies.some(e=>e.alive)?'#f00':'#0f0';ctx.font='bold 34px Orbitron';ctx.textAlign='center';ctx.fillText(enemies.some(e=>e.alive)?'GAME OVER':'–ü–û–ë–ï–î–ê!',240,260);ctx.fillStyle='#fff';ctx.font='22px Orbitron';ctx.fillText('–°—á—ë—Ç: '+score,240,310);ctx.textAlign='left';}}
gameLoop=setInterval(loop,30);cv.onclick=()=>{if(over)game_invaders(area);};}

// ASTEROIDS
function game_asteroids(area){const cv=createCanvas(area,550,550);const ctx=cv.getContext('2d');setHint('‚Üê ‚Üí ‚Üë –ü—Ä–æ–±–µ–ª');let ship={x:275,y:275,angle:0,vx:0,vy:0},bullets=[],asteroids=[],score=0,over=false;for(let i=0;i<5;i++)asteroids.push({x:Math.random()*550,y:Math.random()*550,size:45,vx:(Math.random()-0.5)*2,vy:(Math.random()-0.5)*2,angle:0,va:Math.random()*0.04});let keys={};document.onkeydown=e=>{keys[e.code]=true;if(e.code==='Space'&&!over)bullets.push({x:ship.x+Math.cos(ship.angle)*18,y:ship.y+Math.sin(ship.angle)*18,vx:Math.cos(ship.angle)*8,vy:Math.sin(ship.angle)*8});e.preventDefault();};document.onkeyup=e=>keys[e.code]=false;
function loop(){if(over)return;if(keys['ArrowLeft'])ship.angle-=0.08;if(keys['ArrowRight'])ship.angle+=0.08;if(keys['ArrowUp']){ship.vx+=Math.cos(ship.angle)*0.15;ship.vy+=Math.sin(ship.angle)*0.15;}ship.x+=ship.vx;ship.y+=ship.vy;ship.vx*=0.99;ship.vy*=0.99;if(ship.x<0)ship.x=550;if(ship.x>550)ship.x=0;if(ship.y<0)ship.y=550;if(ship.y>550)ship.y=0;bullets.forEach(b=>{b.x+=b.vx;b.y+=b.vy;});bullets=bullets.filter(b=>b.x>0&&b.x<550&&b.y>0&&b.y<550);asteroids.forEach(a=>{a.x+=a.vx;a.y+=a.vy;a.angle+=a.va;if(a.x<-50)a.x=600;if(a.x>600)a.x=-50;if(a.y<-50)a.y=600;if(a.y>600)a.y=-50;});
bullets.forEach(b=>{asteroids.forEach(a=>{if(!a.hit&&Math.hypot(b.x-a.x,b.y-a.y)<a.size){a.hit=true;score+=Math.floor(100/a.size*10);setScore(score);if(a.size>18){asteroids.push({x:a.x,y:a.y,size:a.size/2,vx:(Math.random()-0.5)*3,vy:(Math.random()-0.5)*3,angle:0,va:Math.random()*0.04});asteroids.push({x:a.x,y:a.y,size:a.size/2,vx:(Math.random()-0.5)*3,vy:(Math.random()-0.5)*3,angle:0,va:Math.random()*0.04});}}});});asteroids=asteroids.filter(a=>!a.hit);asteroids.forEach(a=>{if(Math.hypot(ship.x-a.x,ship.y-a.y)<a.size+8)over=true;});if(asteroids.length<3)asteroids.push({x:Math.random()*550,y:0,size:35+Math.random()*15,vx:(Math.random()-0.5)*2,vy:(Math.random()-0.5)*2,angle:0,va:Math.random()*0.04});
ctx.fillStyle='#000';ctx.fillRect(0,0,550,550);asteroids.forEach(a=>{ctx.save();ctx.translate(a.x,a.y);ctx.rotate(a.angle);ctx.strokeStyle='#888';ctx.lineWidth=2;ctx.beginPath();for(let i=0;i<8;i++){const r=a.size*(0.8+Math.sin(i*1.3)*0.2),ang=i*Math.PI/4;if(i===0)ctx.moveTo(Math.cos(ang)*r,Math.sin(ang)*r);else ctx.lineTo(Math.cos(ang)*r,Math.sin(ang)*r);}ctx.closePath();ctx.stroke();ctx.restore();});ctx.save();ctx.translate(ship.x,ship.y);ctx.rotate(ship.angle);ctx.strokeStyle='#0f0';ctx.lineWidth=2;ctx.beginPath();ctx.moveTo(18,0);ctx.lineTo(-12,-10);ctx.lineTo(-8,0);ctx.lineTo(-12,10);ctx.closePath();ctx.stroke();if(keys['ArrowUp']){ctx.fillStyle='#f80';ctx.beginPath();ctx.moveTo(-8,-4);ctx.lineTo(-20,0);ctx.lineTo(-8,4);ctx.fill();}ctx.restore();ctx.fillStyle='#ff0';bullets.forEach(b=>{ctx.beginPath();ctx.arc(b.x,b.y,3,0,Math.PI*2);ctx.fill();});
if(over){ctx.fillStyle='rgba(0,0,0,0.8)';ctx.fillRect(0,0,550,550);ctx.fillStyle='#f44';ctx.font='bold 34px Orbitron';ctx.textAlign='center';ctx.fillText('GAME OVER',275,260);ctx.fillStyle='#fff';ctx.font='22px Orbitron';ctx.fillText('–°—á—ë—Ç: '+score,275,310);ctx.textAlign='left';}}
gameLoop=setInterval(loop,30);cv.onclick=()=>{if(over)game_asteroids(area);};}

// –ú–ê–†–ò–û
function game_mario(area){const cv=createCanvas(area,650,400);const ctx=cv.getContext('2d');setHint('‚Üê ‚Üí –ü—Ä–æ–±–µ–ª');let player={x:50,y:310,vx:0,vy:0,w:26,h:36,onGround:false},score=0,lives=3,over=false,win=false,cameraX=0;const levelWidth=2500;let platforms=[{x:0,y:350,w:700,h:50},{x:800,y:350,w:500,h:50},{x:1400,y:350,w:700,h:50},{x:2200,y:350,w:300,h:50},{x:180,y:270,w:90,h:22},{x:350,y:220,w:45,h:22,type:'q'},{x:600,y:180,w:100,h:22},{x:900,y:280,w:130,h:22},{x:1100,y:200,w:45,h:22,type:'q'},{x:1300,y:270,w:90,h:22},{x:1600,y:220,w:130,h:22},{x:1850,y:170,w:45,h:22,type:'q'},{x:2000,y:250,w:90,h:22}];let coins=[];for(let i=0;i<20;i++)coins.push({x:130+i*120,y:180+Math.sin(i)*40,collected:false});let enemies=[{x:320,y:320,vx:-1,alive:true},{x:700,y:320,vx:1,alive:true},{x:1500,y:320,vx:-1,alive:true},{x:2100,y:320,vx:1,alive:true}];let keys={};document.onkeydown=e=>{keys[e.code]=true;if(['Space','ArrowUp'].includes(e.code))e.preventDefault();};document.onkeyup=e=>keys[e.code]=false;
function loop(){if(over||win)return;if(keys['ArrowLeft']||keys['KeyA'])player.vx=-4;else if(keys['ArrowRight']||keys['KeyD'])player.vx=4;else player.vx*=0.8;if((keys['Space']||keys['ArrowUp']||keys['KeyW'])&&player.onGround){player.vy=-11;player.onGround=false;}player.vy+=0.5;player.x+=player.vx;player.y+=player.vy;if(player.x<0)player.x=0;if(player.x>levelWidth-player.w)player.x=levelWidth-player.w;if(player.y>450){lives--;if(lives<=0)over=true;else{player.x=50;player.y=310;cameraX=0;}}
player.onGround=false;platforms.forEach(p=>{if(player.x+player.w>p.x&&player.x<p.x+p.w){if(player.y+player.h>p.y&&player.y+player.h<p.y+p.h+12&&player.vy>=0){player.y=p.y-player.h;player.vy=0;player.onGround=true;}if(player.y<p.y+p.h&&player.y>p.y-8&&player.vy<0){player.vy=2;if(p.type==='q'&&!p.hit){p.hit=true;score+=100;setScore(score);}}}});
coins.forEach(c=>{if(!c.collected&&Math.abs(player.x+13-c.x)<22&&Math.abs(player.y+18-c.y)<22){c.collected=true;score+=50;setScore(score);}});
enemies.forEach(e=>{if(!e.alive)return;e.x+=e.vx;if(e.x<50||e.x>levelWidth-50)e.vx*=-1;if(player.x+player.w>e.x&&player.x<e.x+28&&player.y+player.h>e.y&&player.y<e.y+28){if(player.vy>0&&player.y+player.h<e.y+12){e.alive=false;player.vy=-8;score+=100;setScore(score);}else{lives--;if(lives<=0)over=true;else{player.x=Math.max(50,player.x-80);player.vy=-6;}}}});
if(player.x>levelWidth-80){win=true;score+=1000;setScore(score);}cameraX=Math.max(0,Math.min(levelWidth-650,player.x-220));
ctx.fillStyle='#5c94fc';ctx.fillRect(0,0,650,400);ctx.fillStyle='rgba(255,255,255,0.9)';for(let i=0;i<5;i++){const cx=(i*350+80-cameraX*0.3)%800-80;ctx.beginPath();ctx.arc(cx,45+i*12,25,0,Math.PI*2);ctx.arc(cx+25,38+i*12,20,0,Math.PI*2);ctx.arc(cx+48,45+i*12,23,0,Math.PI*2);ctx.fill();}
platforms.forEach(p=>{const px=p.x-cameraX;if(px>-p.w&&px<650){if(p.h>30){ctx.fillStyle='#5a3';ctx.fillRect(px,p.y,p.w,8);ctx.fillStyle='#8b5a2b';ctx.fillRect(px,p.y+8,p.w,p.h-8);}else if(p.type==='q'){ctx.fillStyle=p.hit?'#8b4513':'#f90';ctx.fillRect(px,p.y,p.w,p.h);if(!p.hit){ctx.fillStyle='#fff';ctx.font='bold 16px sans-serif';ctx.fillText('?',px+16,p.y+16);}}else{ctx.fillStyle='#27ae60';ctx.fillRect(px,p.y,p.w,p.h);}}});
coins.forEach(c=>{if(c.collected)return;const cx=c.x-cameraX;if(cx>-15&&cx<665){ctx.fillStyle='#f1c40f';ctx.beginPath();ctx.arc(cx,c.y,10,0,Math.PI*2);ctx.fill();}});
enemies.forEach(e=>{if(!e.alive)return;const ex=e.x-cameraX;if(ex>-25&&ex<675){ctx.fillStyle='#8b4513';ctx.beginPath();ctx.arc(ex+14,e.y+6,12,Math.PI,0);ctx.fill();ctx.fillStyle='#d2691e';ctx.fillRect(ex+2,e.y+6,24,20);ctx.fillStyle='#fff';ctx.beginPath();ctx.arc(ex+8,e.y+4,3,0,Math.PI*2);ctx.arc(ex+20,e.y+4,3,0,Math.PI*2);ctx.fill();}});
const fx=levelWidth-70-cameraX;if(fx>-40&&fx<690){ctx.fillStyle='#2ecc71';ctx.fillRect(fx+8,180,6,170);ctx.fillStyle='#e74c3c';ctx.beginPath();ctx.moveTo(fx+14,180);ctx.lineTo(fx+55,200);ctx.lineTo(fx+14,220);ctx.fill();}
const px=player.x-cameraX;ctx.fillStyle='#e74c3c';ctx.beginPath();ctx.arc(px+13,player.y+7,9,Math.PI,0);ctx.fill();ctx.fillRect(px+4,player.y+7,18,4);ctx.fillStyle='#ffeaa7';ctx.beginPath();ctx.arc(px+13,player.y+10,7,0,Math.PI*2);ctx.fill();ctx.fillStyle='#e74c3c';ctx.fillRect(px+4,player.y+16,18,10);ctx.fillStyle='#2980b9';ctx.fillRect(px+5,player.y+25,7,11);ctx.fillRect(px+14,player.y+25,7,11);
ctx.fillStyle='#fff';ctx.font='bold 16px sans-serif';ctx.fillText('‚ù§Ô∏è '+lives,15,25);ctx.fillText('ü™ô '+score,100,25);
if(over||win){ctx.fillStyle='rgba(0,0,0,0.8)';ctx.fillRect(0,0,650,400);ctx.fillStyle=win?'#2ecc71':'#e74c3c';ctx.font='bold 36px Orbitron';ctx.textAlign='center';ctx.fillText(win?'–ü–û–ë–ï–î–ê!':'GAME OVER',325,180);ctx.fillStyle='#fff';ctx.font='22px Orbitron';ctx.fillText('–°—á—ë—Ç: '+score,325,225);ctx.textAlign='left';}}
gameLoop=setInterval(loop,16);cv.onclick=()=>{if(over||win)game_mario(area);};}

// 2048
function game_2048(area){area.innerHTML=`<div class="game-score">–°—á—ë—Ç: <span id="score">0</span></div><div id="grid" style="display:grid;grid-template-columns:repeat(4,75px);gap:10px;background:#bbada0;padding:12px;border-radius:12px;"></div><div class="game-hint">–°—Ç—Ä–µ–ª–∫–∏</div>`;let grid=Array(4).fill().map(()=>Array(4).fill(0)),score=0;const colors={0:'#cdc1b4',2:'#eee4da',4:'#ede0c8',8:'#f2b179',16:'#f59563',32:'#f67c5f',64:'#f65e3b',128:'#edcf72',256:'#edcc61',512:'#edc850',1024:'#edc53f',2048:'#edc22e'};function addTile(){const empty=[];grid.forEach((r,y)=>r.forEach((v,x)=>{if(!v)empty.push({x,y});}));if(empty.length){const{x,y}=empty[Math.floor(Math.random()*empty.length)];grid[y][x]=Math.random()<0.9?2:4;}}function render(){document.getElementById('grid').innerHTML=grid.flat().map(v=>`<div style="width:75px;height:75px;display:flex;align-items:center;justify-content:center;background:${colors[v]||'#3c3a32'};color:${v>4?'#f9f6f2':'#776e65'};font-family:Orbitron;font-weight:700;font-size:${v>99?v>999?'1.1rem':'1.4rem':'1.8rem'};border-radius:6px;">${v||''}</div>`).join('');}function slide(row){let a=row.filter(x=>x);for(let i=0;i<a.length-1;i++)if(a[i]===a[i+1]){a[i]*=2;score+=a[i];a.splice(i+1,1);}while(a.length<4)a.push(0);return a;}function move(dir){const old=JSON.stringify(grid);if(dir==='left')grid=grid.map(r=>slide(r));if(dir==='right')grid=grid.map(r=>slide(r.reverse()).reverse());if(dir==='up')for(let x=0;x<4;x++){let c=grid.map(r=>r[x]);c=slide(c);c.forEach((v,y)=>grid[y][x]=v);}if(dir==='down')for(let x=0;x<4;x++){let c=grid.map(r=>r[x]).reverse();c=slide(c).reverse();c.forEach((v,y)=>grid[y][x]=v);}if(JSON.stringify(grid)!==old){addTile();setScore(score);}render();}document.onkeydown=e=>{if(e.key==='ArrowLeft')move('left');if(e.key==='ArrowRight')move('right');if(e.key==='ArrowUp')move('up');if(e.key==='ArrowDown')move('down');e.preventDefault();};addTile();addTile();render();}

// –ü–ê–ú–Ø–¢–¨
function game_memory(area){area.innerHTML=`<div class="game-score">–•–æ–¥—ã: <span id="score">0</span></div><div id="grid" style="display:grid;grid-template-columns:repeat(4,75px);gap:10px;justify-content:center;"></div><div class="game-hint">–ù–∞–π–¥–∏—Ç–µ –ø–∞—Ä—ã</div>`;const emojis=['üéÆ','üé≤','üéØ','üèÜ','‚≠ê','üíé','üî•','üíú'];let cards=[...emojis,...emojis].sort(()=>Math.random()-0.5),flipped=[],matched=[],moves=0;function render(){document.getElementById('grid').innerHTML=cards.map((e,i)=>{const f=flipped.includes(i)||matched.includes(i),m=matched.includes(i);return`<button onclick="memClick(${i})" style="width:75px;height:75px;font-size:1.8rem;border:none;border-radius:10px;cursor:pointer;background:${m?'linear-gradient(135deg,#0f8,#0cf)':f?'#2a2a4a':'linear-gradient(135deg,#667eea,#764ba2)'};color:${f?'white':'transparent'}">${f?e:'‚ùì'}</button>`;}).join('');}window.memClick=i=>{if(flipped.length===2||flipped.includes(i)||matched.includes(i))return;flipped.push(i);render();if(flipped.length===2){moves++;setScore(moves);if(cards[flipped[0]]===cards[flipped[1]]){matched.push(...flipped);flipped=[];if(matched.length===16)setTimeout(()=>alert('üéâ –ü–æ–±–µ–¥–∞! –•–æ–¥–æ–≤: '+moves),300);}else setTimeout(()=>{flipped=[];render();},1000);}};render();}

// –ö–†–ï–°–¢–ò–ö–ò-–ù–û–õ–ò–ö–ò
function game_tictactoe(area){area.innerHTML=`<div id="status" style="font-family:Orbitron;font-size:1.2rem;color:#f1c40f;">–í–∞—à —Ö–æ–¥ (X)</div><div id="grid" style="display:grid;grid-template-columns:repeat(3,90px);gap:10px;justify-content:center;margin:18px 0;"></div><button onclick="game_tictactoe(document.getElementById('gameArea'))" style="padding:12px 30px;border:none;border-radius:25px;background:linear-gradient(135deg,#e74c3c,#c0392b);color:white;font-family:Orbitron;cursor:pointer;">–ó–∞–Ω–æ–≤–æ</button>`;let board=Array(9).fill(''),player='X',over=false;const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];function render(){document.getElementById('grid').innerHTML=board.map((c,i)=>`<button onclick="tttClick(${i})" style="width:90px;height:90px;font-size:2.8rem;font-weight:900;border:none;border-radius:12px;cursor:pointer;background:linear-gradient(135deg,#2c3e50,#34495e);color:${c==='X'?'#3498db':'#e74c3c'}">${c}</button>`).join('');}window.tttClick=i=>{if(board[i]||over)return;board[i]=player;for(let[a,b,c]of wins)if(board[a]&&board[a]===board[b]&&board[b]===board[c]){over=true;document.getElementById('status').textContent=board[a]+' –ø–æ–±–µ–¥–∏–ª! üéâ';render();return;}if(!board.includes('')){over=true;document.getElementById('status').textContent='–ù–∏—á—å—è! ü§ù';render();return;}player=player==='X'?'O':'X';document.getElementById('status').textContent=player==='X'?'–í–∞—à —Ö–æ–¥ (X)':'–•–æ–¥ AI (O)';render();if(player==='O'&&!over)setTimeout(()=>{const empty=board.map((v,i)=>v?-1:i).filter(i=>i>=0);if(empty.length)tttClick(empty[Math.floor(Math.random()*empty.length)]);},500);};render();}

// –ì–û–ù–ö–ò
function game_road(area){const cv=createCanvas(area,450,550);const ctx=cv.getContext('2d');setHint('‚Üê ‚Üí');let px=200,score=0,speed=5,obstacles=[],roadOffset=0;let keys={};document.onkeydown=e=>{keys[e.key]=true;e.preventDefault();};document.onkeyup=e=>keys[e.key]=false;function loop(){if(keys['ArrowLeft'])px=Math.max(80,px-7);if(keys['ArrowRight'])px=Math.min(330,px+7);roadOffset=(roadOffset+speed)%40;if(Math.random()<0.025)obstacles.push({x:80+Math.random()*260,y:-50,w:45,h:70});obstacles.forEach(o=>o.y+=speed);let hit=false;obstacles.forEach(o=>{if(o.y>440&&o.y<530&&Math.abs(o.x+22-px-22)<40)hit=true;});obstacles=obstacles.filter(o=>{if(o.y>550){score++;setScore(score);return false;}return true;});if(hit){alert('üí• –ê–≤–∞—Ä–∏—è! –°—á—ë—Ç: '+score);game_road(area);return;}speed=5+score*0.08;ctx.fillStyle='#2d5a27';ctx.fillRect(0,0,450,550);ctx.fillStyle='#444';ctx.fillRect(60,0,330,550);ctx.strokeStyle='#fff';ctx.lineWidth=3;ctx.setLineDash([25,18]);ctx.lineDashOffset=-roadOffset;ctx.beginPath();ctx.moveTo(225,0);ctx.lineTo(225,550);ctx.stroke();ctx.setLineDash([]);obstacles.forEach(o=>{ctx.fillStyle='#e74c3c';ctx.beginPath();ctx.roundRect(o.x,o.y,o.w,o.h,8);ctx.fill();ctx.fillStyle='#f1c40f';ctx.fillRect(o.x+4,o.y+o.h-8,8,6);ctx.fillRect(o.x+o.w-12,o.y+o.h-8,8,6);});ctx.fillStyle='#3498db';ctx.beginPath();ctx.roundRect(px,460,45,70,8);ctx.fill();ctx.fillStyle='#2980b9';ctx.fillRect(px+4,468,37,16);ctx.fillStyle='#fff';ctx.font='bold 18px Orbitron';ctx.fillText('üèéÔ∏è '+score,15,30);}gameLoop=setInterval(loop,20);}

// –§–£–¢–ë–û–õ
function game_football(area){const cv=createCanvas(area,550,360);const ctx=cv.getContext('2d');setHint('–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –º—è—á—É!');let ball={x:275,y:270,vx:0,vy:0},score=0,shots=10;cv.onclick=e=>{const r=cv.getBoundingClientRect();const mx=e.clientX-r.left,my=e.clientY-r.top;if(Math.abs(ball.x-mx)<28&&Math.abs(ball.y-my)<28&&shots>0){ball.vx=(275-ball.x)*0.08+(Math.random()-0.5)*4;ball.vy=-13-Math.random()*4;shots--;}};function loop(){ball.vy+=0.45;ball.x+=ball.vx;ball.y+=ball.vy;ball.vx*=0.98;if(ball.y>290){ball.y=290;ball.vy*=-0.55;if(Math.abs(ball.vy)<0.8)ball.vy=0;}if(ball.x<18||ball.x>532)ball.vx*=-0.75;if(ball.y<70&&ball.x>180&&ball.x<370){score++;setScore(score);ball.x=275;ball.y=270;ball.vx=0;ball.vy=0;}ctx.fillStyle='#27ae60';ctx.fillRect(0,0,550,360);ctx.strokeStyle='#fff';ctx.lineWidth=2;ctx.strokeRect(15,15,520,330);ctx.beginPath();ctx.arc(275,180,50,0,Math.PI*2);ctx.stroke();ctx.fillStyle='#fff';ctx.fillRect(175,15,200,8);ctx.fillRect(175,15,4,60);ctx.fillRect(371,15,4,60);ctx.fillStyle='#fff';ctx.beginPath();ctx.arc(ball.x,ball.y,18,0,Math.PI*2);ctx.fill();ctx.fillStyle='#fff';ctx.font='bold 18px Orbitron';ctx.fillText('‚öΩ '+score,15,345);ctx.fillText('–£–¥–∞—Ä—ã: '+shots,420,345);if(shots<=0&&Math.abs(ball.vy)<0.5){ctx.fillStyle='rgba(0,0,0,0.7)';ctx.fillRect(0,0,550,360);ctx.fillStyle='#f1c40f';ctx.font='bold 32px Orbitron';ctx.textAlign='center';ctx.fillText('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!',275,160);ctx.fillStyle='#fff';ctx.font='22px Orbitron';ctx.fillText('–ì–æ–ª–æ–≤: '+score,275,205);ctx.textAlign='left';cv.onclick=()=>game_football(area);}}gameLoop=setInterval(loop,20);}

// –°–ò–ú–û–ù
function game_simon(area){area.innerHTML=`<div class="game-score">–£—Ä–æ–≤–µ–Ω—å: <span id="score">1</span></div><div id="grid" style="display:grid;grid-template-columns:repeat(2,110px);gap:12px;justify-content:center;margin:18px 0;"></div><button id="startBtn" onclick="simonStart()" style="padding:12px 35px;border:none;border-radius:25px;background:linear-gradient(135deg,#00b894,#00cec9);color:#fff;font-family:Orbitron;cursor:pointer;">‚ñ∂ –°—Ç–∞—Ä—Ç</button><div class="game-hint">–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ</div>`;const colors=[['#e74c3c','#ff6b6b'],['#27ae60','#2ecc71'],['#2980b9','#3498db'],['#f1c40f','#f39c12']];let sequence=[],playerSeq=[],level=1,playing=false;function render(){document.getElementById('grid').innerHTML=colors.map((c,i)=>`<button id="btn${i}" onclick="simonClick(${i})" style="width:110px;height:110px;border:none;border-radius:18px;background:linear-gradient(135deg,${c[0]},${c[1]});opacity:0.4;cursor:pointer;"></button>`).join('');}function flash(i){const btn=document.getElementById('btn'+i);btn.style.opacity='1';btn.style.transform='scale(1.08)';setTimeout(()=>{btn.style.opacity='0.4';btn.style.transform='scale(1)';},350);}window.simonStart=()=>{sequence=[Math.floor(Math.random()*4)];playerSeq=[];level=1;setScore(level);playing=false;let i=0;const int=setInterval(()=>{flash(sequence[i]);i++;if(i>=sequence.length){clearInterval(int);playing=true;}},650);};window.simonClick=i=>{if(!playing)return;flash(i);playerSeq.push(i);if(playerSeq[playerSeq.length-1]!==sequence[playerSeq.length-1]){alert('‚ùå –û—à–∏–±–∫–∞! –£—Ä–æ–≤–µ–Ω—å: '+level);return;}if(playerSeq.length===sequence.length){level++;setScore(level);playerSeq=[];sequence.push(Math.floor(Math.random()*4));playing=false;setTimeout(()=>{let i=0;const int=setInterval(()=>{flash(sequence[i]);i++;if(i>=sequence.length){clearInterval(int);playing=true;}},650);},900);}};render();}

// –ö–õ–ò–ö–ï–†
function game_clicker(area){area.innerHTML=`<div class="game-score">üí∞ <span id="score">0</span></div><button id="clkBtn" style="width:160px;height:160px;border-radius:50%;border:none;background:linear-gradient(135deg,#f1c40f,#e67e22);font-size:4.5rem;cursor:pointer;">üí∞</button><div style="margin-top:22px;display:flex;gap:12px;"><button onclick="buyUpgrade(1)" style="padding:10px 22px;border:none;border-radius:12px;background:linear-gradient(135deg,#3498db,#2980b9);color:white;font-weight:700;cursor:pointer;">+1 (üí∞10)</button><button onclick="buyUpgrade(2)" style="padding:10px 22px;border:none;border-radius:12px;background:linear-gradient(135deg,#9b59b6,#8e44ad);color:white;font-weight:700;cursor:pointer;">+5 (üí∞50)</button></div><div class="game-hint">–ö–ª–∏–∫: <span id="mult">1</span> üí∞</div>`;let coins=0,mult=1;document.getElementById('clkBtn').onclick=()=>{coins+=mult;setScore(coins);const btn=document.getElementById('clkBtn');btn.style.transform='scale(0.9)';setTimeout(()=>btn.style.transform='scale(1)',90);};window.buyUpgrade=t=>{if(t===1&&coins>=10){coins-=10;mult++;setScore(coins);document.getElementById('mult').textContent=mult;}if(t===2&&coins>=50){coins-=50;mult+=5;setScore(coins);document.getElementById('mult').textContent=mult;}};}

// –†–ï–ê–ö–¶–ò–Ø
function game_reaction(area){area.innerHTML=`<div class="game-score">üèÜ –õ—É—á—à–µ–µ: <span id="score">-</span> –º—Å</div><div id="box" style="width:320px;height:200px;background:linear-gradient(135deg,#e74c3c,#c0392b);border-radius:18px;display:flex;align-items:center;justify-content:center;font-size:1.3rem;color:white;cursor:pointer;">‚è≥ –ñ–¥–∏—Ç–µ –∑–µ–ª—ë–Ω—ã–π...</div><div class="game-hint">–ù–∞–∂–º–∏—Ç–µ –±—ã—Å—Ç—Ä–µ–µ!</div>`;let waiting=true,start=0,best=Infinity,timeout;function reset(){waiting=true;const box=document.getElementById('box');box.style.background='linear-gradient(135deg,#e74c3c,#c0392b)';box.textContent='‚è≥ –ñ–¥–∏—Ç–µ –∑–µ–ª—ë–Ω—ã–π...';timeout=setTimeout(()=>{if(!waiting)return;waiting=false;start=Date.now();box.style.background='linear-gradient(135deg,#27ae60,#2ecc71)';box.textContent='üéØ –ñ–ú–ò–¢–ï!';},1000+Math.random()*3000);}document.getElementById('box').onclick=()=>{const box=document.getElementById('box');if(waiting){clearTimeout(timeout);box.style.background='linear-gradient(135deg,#e67e22,#d35400)';box.textContent='‚ö° –†–∞–Ω–æ!';setTimeout(reset,1400);}else{const time=Date.now()-start;if(time<best){best=time;setScore(best);}box.style.background='linear-gradient(135deg,#3498db,#2980b9)';box.textContent='‚è±Ô∏è '+time+' –º—Å';setTimeout(reset,1800);}};reset();}

// –†–´–ë–ê–õ–ö–ê
function game_fishing(area){const cv=createCanvas(area,450,450);const ctx=cv.getContext('2d');setHint('–ö–ª–∏–∫–Ω–∏—Ç–µ –∫–æ–≥–¥–∞ –∫–ª—é—ë—Ç!');let score=0,fishing=false,bite=false,fish=[],hookY=130,lineWave=0;for(let i=0;i<7;i++)fish.push({x:Math.random()*360+45,y:220+Math.random()*180,vx:(Math.random()-0.5)*1.8,size:14+Math.random()*18});cv.onclick=()=>{if(bite){score+=10;setScore(score);bite=false;fishing=false;hookY=130;}else if(!fishing){fishing=true;hookY=130;}};function loop(){lineWave+=0.1;if(fishing&&hookY<360)hookY+=2.5;if(fishing&&hookY>=310&&Math.random()<0.018)bite=true;fish.forEach(f=>{f.x+=f.vx;if(f.x<25||f.x>425)f.vx*=-1;f.y+=Math.sin(Date.now()/450+f.x)*0.4;});ctx.fillStyle='#87ceeb';ctx.fillRect(0,0,450,180);ctx.fillStyle='#3498db';ctx.fillRect(0,180,450,270);ctx.strokeStyle='rgba(255,255,255,0.25)';ctx.lineWidth=2;for(let i=0;i<4;i++){ctx.beginPath();for(let x=0;x<450;x+=8){const y=180+i*28+Math.sin(x/28+lineWave+i)*4;if(x===0)ctx.moveTo(x,y);else ctx.lineTo(x,y);}ctx.stroke();}fish.forEach(f=>{ctx.fillStyle='#f39c12';ctx.beginPath();ctx.ellipse(f.x,f.y,f.size,f.size/2,0,0,Math.PI*2);ctx.fill();ctx.beginPath();ctx.moveTo(f.x-f.size,f.y);ctx.lineTo(f.x-f.size-8,f.y-6);ctx.lineTo(f.x-f.size-8,f.y+6);ctx.fill();ctx.fillStyle='#000';ctx.beginPath();ctx.arc(f.x+f.size/2,f.y-2,2.5,0,Math.PI*2);ctx.fill();});ctx.strokeStyle='#8b4513';ctx.lineWidth=3;ctx.beginPath();ctx.moveTo(90,45);ctx.quadraticCurveTo(180,28,225,90);ctx.stroke();ctx.strokeStyle='#ddd';ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(225,90);ctx.lineTo(225+Math.sin(lineWave)*4,hookY);ctx.stroke();ctx.fillStyle=bite?'#e74c3c':'#888';ctx.beginPath();ctx.arc(225,hookY,bite?10:7,0,Math.PI*2);ctx.fill();if(bite){ctx.fillStyle='#fff';ctx.font='bold 15px sans-serif';ctx.textAlign='center';ctx.fillText('–ö–õ–Æ–Å–¢!',225,hookY-18);ctx.textAlign='left';}ctx.fillStyle='#fff';ctx.font='bold 18px Orbitron';ctx.fillText('üêü '+score,18,32);}gameLoop=setInterval(loop,28);}
</script>
</body>
</html>